<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Randomizer</title>
    <style>
        /* CSS for the White Background and Red-Gold Accent Theme */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #ffffff; /* White background */
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }

        .container {
            display: flex;
            width: 90%;
            max-width: 1200px;
            gap: 30px;
        }

        .main-content {
            flex: 2;
            padding: 30px;
            background-color: #f8f8f8;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center; /* Center content in main box */
        }

        .sidebar {
            flex: 1;
            padding: 20px;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            max-height: 80vh;
            overflow-y: auto;
        }

        h1 {
            color: #d32f2f; /* Deep Red accent for main title */
            border-bottom: 3px solid #ffc107; /* Gold accent border */
            padding-bottom: 10px;
            margin-bottom: 30px;
        }

        h2 {
            color: #ffc107; /* Gold accent for sidebar title */
            border-bottom: 2px solid #d32f2f; /* Deep Red accent border */
            padding-bottom: 5px;
            margin-top: 0;
            margin-bottom: 15px;
        }

        /* --- New styles for the rolling animation area --- */
        #result-container {
            display: flex;
            justify-content: center;
            margin: 40px 0 60px 0;
            min-height: 120px;
            border: 5px solid #ffc107; /* Gold border */
            border-radius: 8px;
            background-color: #fffaf0; /* Off-white/Cream background */
            overflow: hidden; /* Hide rolling digits outside the view */
        }

        .digit-slot {
            font-size: 8em;
            color: #d32f2f; /* Deep Red for the result number */
            font-weight: bold;
            line-height: 1.1; /* Adjust line height for better alignment */
            width: 0.8em; /* Fixed width for digits */
            text-align: center;
            /* Animation Container setup */
            height: 1.1em; /* Height of one line (one digit) */
            overflow: hidden;
        }

        .roll-animation {
            /* This is the element that holds the digits and moves up/down */
            transition: transform 0s; /* Initially no transition for quick reset */
        }

        /* Class added during the final stop */
        .stop-animation {
             /* 0.5s transition for the final stopping move */
            transition: transform 0.5s ease-out; 
        }
        /* ---------------------------------------------------- */

        button {
            display: block;
            width: 80%;
            max-width: 400px;
            margin: 0 auto 15px auto;
            padding: 15px;
            font-size: 1.2em;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
        }

        #drawButton {
            background-color: #d32f2f; /* Deep Red button */
            color: white;
        }

        #drawButton:hover {
            background-color: #e53935; /* Lighter Red on hover */
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        #drawButton:disabled {
            background-color: #bdbdbd;
            cursor: not-allowed;
            color: #757575;
        }

        #resetButton {
            background-color: #ffc107; /* Gold button */
            color: #333;
        }

        #resetButton:hover {
            background-color: #ffca28; /* Lighter Gold on hover */
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        #pickedNumbers {
            list-style: none;
            padding: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        #pickedNumbers li {
            background-color: #ffe0b2; /* Light Gold background for numbers */
            color: #d32f2f; /* Red text for numbers */
            padding: 5px 10px;
            border-radius: 5px;
            font-weight: 600;
            font-size: 1.1em;
            border: 1px solid #ffb74d; /* Medium Gold border */
        }
        
        #statusMessage {
            color: #d32f2f;
            font-weight: bold;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-content">
            <h1>ðŸŽ° Randomizer</h1>
            
            <div id="result-container">
                </div>
            
            <button id="drawButton" onclick="startDraw()">DRAW NUMBER</button>
            <button id="resetButton" onclick="resetPicker()">RESET ALL NUMBERS</button>
            
            <div id="statusMessage"></div>
        </div>

        <div class="sidebar">
            <h2>ðŸ“œ Picked Numbers History</h2>
            <ul id="pickedNumbers">
                </ul>
        </div>
    </div>

    <script>
        const MIN_NUM = 1;
        const MAX_NUM = 300;
        const DIGIT_COUNT = 3;
        const ROLL_DURATION = 2000; // Total duration of the roll in milliseconds (2 seconds)
        const DIGIT_STOP_DELAY = 200; // Delay between each digit stopping

        let availableNumbers = [];
        let pickedNumbers = [];
        let isDrawing = false;

        const resultContainer = document.getElementById('result-container');
        const pickedNumbersList = document.getElementById('pickedNumbers');
        const drawButton = document.getElementById('drawButton');
        const statusMessage = document.getElementById('statusMessage');

        /**
         * Initializes the array of available numbers and the digit slots.
         */
        function initializeNumbers() {
            availableNumbers = [];
            for (let i = MIN_NUM; i <= MAX_NUM; i++) {
                availableNumbers.push(i);
            }
            pickedNumbers = [];
            updateDisplay(formatNumber(MIN_NUM)); // Set initial display to '001'
        }

        /**
         * Formats a number to be three digits (e.g., 1 -> '001').
         * @param {number} num - The number to format.
         * @returns {string} The three-digit formatted string.
         */
        function formatNumber(num) {
            return String(num).padStart(DIGIT_COUNT, '0');
        }

        /**
         * Sets up the HTML structure for the rolling digits.
         * @param {string} initialText - The initial number string (e.g., '001').
         */
        function setupDigitSlots(initialText) {
            resultContainer.innerHTML = '';
            for (let i = 0; i < DIGIT_COUNT; i++) {
                const digitSlot = document.createElement('div');
                digitSlot.className = 'digit-slot';

                const rollAnimation = document.createElement('div');
                rollAnimation.className = 'roll-animation';
                
                // Create digits 0-9 for rolling
                for (let j = 0; j <= 9; j++) {
                    const span = document.createElement('span');
                    span.textContent = j;
                    rollAnimation.appendChild(span);
                }

                // Append the initial digit from the initialText at the top of the roll
                const initialSpan = document.createElement('span');
                initialSpan.textContent = initialText[i];
                rollAnimation.appendChild(initialSpan);

                digitSlot.appendChild(rollAnimation);
                resultContainer.appendChild(digitSlot);

                // Set initial position to show the correct starting digit ('0', '0', '1')
                const initialDigit = parseInt(initialText[i]);
                // Total of 11 spans (0-9 plus the initial one)
                // We want the initial one (index 10) to be visible.
                // The height of a digit is 1.1em, so the offset is index * 1.1em.
                // We calculate the position based on the index of the digit we want to show.
                // Since we add the initial digit *after* 0-9, it's at index 10.
                rollAnimation.style.transform = `translateY(-${initialDigit * 1.1}em)`;
            }
        }

        /**
         * Starts the drawing process, including the rolling animation.
         */
        function startDraw() {
            if (isDrawing || availableNumbers.length === 0) return;
            
            isDrawing = true;
            drawButton.disabled = true;
            statusMessage.textContent = '...Rolling...';

            const selectedNumber = drawRandomNumber();
            const targetString = formatNumber(selectedNumber);

            // 1. Start the fast roll
            const rollElements = document.querySelectorAll('.roll-animation');
            rollElements.forEach(roll => {
                // Set transition to 0s to reset any previous final stop quickly
                roll.style.transition = 'transform 0s'; 
                // Set transform to a large negative value to start rapid rolling visually
                roll.style.transform = 'translateY(-1000em)'; 
            });

            // 2. Schedule the roll stop for each digit
            for (let i = 0; i < DIGIT_COUNT; i++) {
                setTimeout(() => {
                    stopDigit(i, targetString[i]);
                }, ROLL_DURATION + (i * DIGIT_STOP_DELAY));
            }

            // 3. Schedule the final update after all digits have stopped
            setTimeout(() => {
                isDrawing = false;
                updateDisplay(selectedNumber);
            }, ROLL_DURATION + (DIGIT_COUNT * DIGIT_STOP_DELAY) + 500); // Wait a little longer
        }

        /**
         * Stops an individual digit on its target value.
         * @param {number} index - The index of the digit slot (0, 1, or 2).
         * @param {string} targetDigit - The final digit character ('0' through '9').
         */
        function stopDigit(index, targetDigit) {
            const roll = document.querySelectorAll('.roll-animation')[index];
            const targetIndex = parseInt(targetDigit); // 0 corresponds to the 0 span, 1 to the 1 span, etc.
            
            // Calculate the position required to show the target digit.
            // Each digit takes up 1.1em in height.
            const offset = targetIndex * 1.1; 

            // Enable the smooth transition and set the final position
            roll.classList.add('stop-animation');
            roll.style.transform = `translateY(-${offset}em)`;
        }

        /**
         * Selects and removes a number from the available pool.
         * @returns {number} The selected number.
         */
        function drawRandomNumber() {
            if (availableNumbers.length === 0) return 0; // Should be handled before calling
            
            const randomIndex = Math.floor(Math.random() * availableNumbers.length);
            const selectedNumber = availableNumbers[randomIndex];
            availableNumbers.splice(randomIndex, 1); 
            pickedNumbers.push(selectedNumber);
            return selectedNumber;
        }

        /**
         * Updates the sidebar and checks the available number status.
         * @param {number} [lastPicked=null] - The last number drawn, if any.
         */
        function updateDisplay(lastPicked) {
            
            // Re-setup digit slots to display the new number (this resets the visual roll elements)
            setupDigitSlots(formatNumber(lastPicked));

            // Reset animation class
            document.querySelectorAll('.roll-animation').forEach(roll => {
                roll.classList.remove('stop-animation');
            });

            // Update status and button state
            if (availableNumbers.length === 0) {
                drawButton.disabled = true;
                statusMessage.textContent = 'All numbers have been picked!';
            } else {
                drawButton.disabled = false;
                statusMessage.textContent = '';
            }

            // Re-render the picked numbers list (sidebar)
            pickedNumbersList.innerHTML = ''; 
            const sortedPicked = [...pickedNumbers].sort((a, b) => a - b); 

            sortedPicked.forEach(number => {
                const li = document.createElement('li');
                li.textContent = formatNumber(number);
                pickedNumbersList.appendChild(li);
            });
        }

        /**
         * Resets the entire picker state.
         */
        function resetPicker() {
            if (confirm("Are you sure you want to reset and clear all picked numbers?")) {
                initializeNumbers();
                statusMessage.textContent = '';
            }
        }

        // Initialize the numbers and set up the display when the page loads
        document.addEventListener('DOMContentLoaded', initializeNumbers);
    </script>
</body>
</html>